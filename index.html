<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
  <meta name="description" content="VS Code for Web - A full-featured web-based code editor with remote source loading capabilities" />
  <meta name="keywords" content="vscode, web editor, code editor, programming, development" />
  <meta name="author" content="khanghh" />
  <meta name="theme-color" content="#1e1e1e" />
  <meta name="color-scheme" content="dark light" />


  <!-- Favicon and icons -->
  <link rel="icon" type="image/x-icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='%23007acc' d='M24 12L14.3 21.7L12.9 20.3L20.2 13H0V11H20.2L12.9 3.7L14.3 2.3L24 12Z'/></svg>" />

  <title>VS Code for Web</title>

  <!-- Load critical resources -->
  <script src="/out/vs/loader.js"></script>
  <script src="/out/vs/webPackagePaths.js"></script>
  <script>
    // Configure web package paths
    Object.keys(self.webPackagePaths).map(function (key, index) {
      self.webPackagePaths[key] = `${window.location.origin}/node_modules/${key}/${self.webPackagePaths[key]}`;
    });

    require.config({
      baseUrl: `${window.location.origin}/out`,
      recordStats: true,
      trustedTypesPolicy: window.trustedTypes?.createPolicy('amdLoader', {
        createScriptURL(value) {
          return value;
        }
      }),
      paths: self.webPackagePaths
    });
  </script>

  <!-- Main CSS -->
  <link data-name="vs/workbench/workbench.web.main" rel="stylesheet" href="/out/vs/workbench/workbench.web.main.css" />

</head>

<body style="margin: 0; height: 100vh; overflow: hidden;">
  <!-- Main application container -->
  <div id="root" style="height: 100vh; width: 100vw" role="main" aria-label="VS Code Editor"></div>
  <script>
    const messageChannel = new MessageChannel();
    const messagePorts = new Map();
    messagePorts.set("remotefs", messageChannel.port2);

    require(["vs/workbench/workbench.web.main"], (workbench) => {
      workbench.create(document.getElementById("root"), {
        productConfiguration: {
          extensionEnabledApiProposals: {
            "khanghh.remotefs": [
              "fileSearchProvider",
              "textSearchProvider",
            ],
          },
          nameShort: "VS Code for Web",
          nameLong: "Visual Studio Code for Web",
          applicationName: "code-web",
          dataFolderName: ".vscode-web",
          version: "1.75.0",
          extensionsGallery: {
            serviceUrl: "https://open-vsx.org/vscode/gallery",
            itemUrl: "https://open-vsx.org/vscode/item",
            resourceUrlTemplate: "https://open-vsx.org/vscode/unpkg/{publisher}/{name}/{version}/{path}",
          },
        },
        additionalBuiltinExtensions: [
          workbench.URI.from({
            scheme: window.location.protocol === "http:" ? "http" : "https",
            path: "/extensions/remotefs",
          })
        ],
        workspaceProvider: {
          workspace: {
              folderUri: workbench.URI.from({
                  path: "/sample-folder",
                  scheme: "memfs"
              })  
          },
          trusted: true
        },
        messagePorts: messagePorts,
      });

      messageChannel.port1.onmessage = (event) => {
        console.log("Received message from remotefs extension:", event.data);
      };
    });

  </script>
</body>

</html>